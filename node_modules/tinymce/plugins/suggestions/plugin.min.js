!function () { "use strict";tinymce.PluginManager.add("suggestions",function(e){let t=e.getParam("search_function",null),o=e.getParam("debounce_time",250),n=e.getParam("suggestion_text_color","#999999"),a=e.getParam("suggestion_node_id","suggestionNodeId"),i=e.getParam("min_search_length",3),s=e.getParam("terms_list",[]),l,r=!1,c,g=["Space","Enter","NumpadEnter","Delete","Escape"],f=["ShiftLeft","ShiftRight","AltRight","AltLeft","ControlLeft","ControlRight"];async function u(e){if(null==t)return s.find(t=>t.toLocaleLowerCase().startsWith(e.toLocaleLowerCase()));{let o=await t(e);return Array.isArray(o)?o.find(t=>t.toLocaleLowerCase().startsWith(e.toLocaleLowerCase())):o.toLocaleLowerCase().startsWith(e.toLocaleLowerCase())?o:void 0}}function d(){l&&l.remove(),l=void 0}function L(e){return -1==g.indexOf(e)}function h(e,t){d();let o=e.selection.getRng(1);(l=e.getDoc().createElement("span")).style.color=n,l.innerHTML=t,l.id=a,e.selection.getSel().focusOffset,o.insertNode(l);let i=e.dom.select(`#${a}`);null!=i[0].lastChild&&e.selection.setCursorLocation(i[0].firstChild,0),e.selection.collapse(0),r=!0,c=t}function m(){r=!1,c=void 0}async function C(e){let t=e.selection.getSel().focusOffset,o=e.selection.getRng(1).startContainer.data;if(o){let n=o.substring(t);if(0==n.length||n.match(/^\s/g)){var a,s,l,r;let c,g=(a=o,s=n,c=RegExp(`${s}$`,"gi"),a.replace(c,"").split(" ").pop());if(g.length>=i){let f=await u(g);if(void 0!=f){let d;h(e,(l=g,r=f,d=RegExp(`^${l}`,"gi"),r.replace(d,"")))}}}}}let p=function e(t,n=o){let a;return(...e)=>{clearTimeout(a),a=setTimeout(()=>{t(...e)},n)}}(async function(e,t){L(e.code)&&C(t),e.key,e.code});e.on("keyup",t=>{r||p(t,e)}),e.on("keydown",t=>{var o,n,a,i;"Tab"==t.code&&r?((o=t).stopPropagation(),o.preventDefault(),n=e,d(),n.execCommand("mceInsertContent",!1,c),n.selection.collapse(1),m()):L(t.code)?r&&-1==f.indexOf(t.code)&&(a=e,i=t.key,c&&c.toLocaleLowerCase().startsWith(i.toLocaleLowerCase())?(c=c.substring(1),d(),h(a,c)):(d(),m())):(d(),m())}),e.on("blur",e=>{d(),m()}),e.on("click",e=>{d(),m()})})}();